tabela <- table(dados$estado_civil,
dados$instrucao)
tabela
total_linha <- margin.table(tabela,2)
total_coluna <- margin.table(tabela,1)
total_linha
total_coluna
tabela_com_totais <-rbind(cbind(tabela,total_coluna),
c(total_linha, sum(total_coluna)))
dimnames(tabela_com_totais)[[1]][3] <- "Total linha"
dimnames(tabela_com_totais)[[2]][4] <- "Total coluna"
tabela_com_totais
tabela <- round(prop.table(tabela),4)
tabela
total_linha <- margin.table(tabela,2)
total_coluna <- margin.table(tabela,1)
total_linha
total_coluna
tabela_com_totais <-rbind(cbind(tabela,total_coluna),
c(total_linha, sum(total_coluna)))
dimnames(tabela_com_totais)[[1]][3] <- "Total linha"
dimnames(tabela_com_totais)[[2]][4] <- "Total coluna"
tabela_com_totais
tabela <- round(prop.table(tabela,2),3)
tabela
total_linha <- margin.table(tabela,2)
total_coluna <- margin.table(tabela,1)
total_linha
total_coluna
tabela_com_totais <-rbind(cbind(tabela,total_coluna),
c(total_linha, sum(total_coluna)))
dimnames(tabela_com_totais)[[1]][3] <- "Total linha"
dimnames(tabela_com_totais)[[2]][4] <- "Total coluna"
tabela_com_totais
tabela <- round(prop.table(tabela,1),3)
tabela
total_linha <- margin.table(tabela,2)
total_coluna <- margin.table(tabela,1)
total_linha
total_coluna
tabela_com_totais <-rbind(cbind(tabela,total_coluna),
c(total_linha, sum(total_coluna)))
dimnames(tabela_com_totais)[[1]][3] <- "Total linha"
dimnames(tabela_com_totais)[[2]][4] <- "Total coluna"
tabela_com_totais
#-----------------------------------------------------------------------
#-----------------------------------------------------------------------
#-----------------------------------------------------------------------
#-----------------------------------------------------------------------
#-----------------------------------------------------------------------
#-----------------------------------------------------------------------
library(tidyverse)
dados <- read.csv("milsa.csv")
summary(dados)
names(dados)
tabela <- table(dados$estado_civil,
dados$instrucao)
tabela <- as.data.frame(tabela)
tabela$freq_r <- tabela$Freq/sum(tabela$Freq)
tabela$freq_r <- round(tabela$freq_r, 2)
ggplot(tabela,
aes(x=Var1, y=Freq, fill=Var2)) +
geom_bar(stat = 'identity',
col = 1,
lwd = 1,
position = 'dodge') +
ylim(c(0,
(max(tabela$Freq)+ (max(tabela$Freq)*0.1))))+
geom_text(aes(label = Freq),
#hjust=-0.1,
color=1,
size=8,
position=position_dodge(width=0.9),
vjust=-0.5
)+
xlab("") +
ylab("Frequência") +
#ggtitle("Situação de emprego x Expectativa após graduação")+
theme_classic() + theme(legend.position = 'top',
plot.title = element_text(family = "Helvetica",
face = "bold",
size = (20),
hjust = 0.5),
axis.title = element_text(face = "bold",
size = 15),
#axis.text = element_blank(),
#legend.title = element_blank(),
text = element_text(size=15))
ggplot(tabela,
aes(x=Var2, y=Freq, fill=Var1)) +
geom_bar(stat = 'identity',
col = 1,
lwd = 1,
position = 'dodge') +
ylim(c(0,
(max(tabela$Freq)+ (max(tabela$Freq)*0.1))))+
geom_text(aes(label = Freq),
#hjust=-0.1,
color=1,
size=8,
position=position_dodge(width=0.9),
vjust=-0.5
)+
xlab("") +
ylab("Frequência") +
#ggtitle("Situação de emprego x Expectativa após graduação")+
theme_classic() + theme(legend.position = 'top',
plot.title = element_text(family = "Helvetica",
face = "bold",
size = (20),
hjust = 0.5),
axis.title = element_text(face = "bold",
size = 15),
#axis.text = element_blank(),
#legend.title = element_blank(),
text = element_text(size=15))
ggplot(tabela,
aes(x=Var1, y=Freq, fill=Var2)) +
geom_bar(stat = 'identity',
col = 1,
lwd = 1)+
#  geom_text(aes(label = freq_r),
#            hjust=0.5,
#            color=1,
#            size=8,
#            position=position_stack(),
#            vjust=1)+
xlab("") +
ylab("Frequência") +
#ggtitle("Situação de emprego x Expectativa após graduação")+
theme_classic() + theme(legend.position = 'top',
plot.title = element_text(family = "Helvetica",
face = "bold",
size = (20),
hjust = 0.5),
axis.title = element_text(face = "bold",
size = 15),
#axis.text = element_blank(),
#legend.title = element_blank(),
text = element_text(size=15))
ggplot(tabela,
aes(x=Var2, y=Freq, fill=Var1)) +
geom_bar(stat = 'identity',
col = 1,
lwd = 1)+
#  geom_text(aes(label = freq_r),
#            hjust=0.5,
#            color=1,
#            size=8,
#            position=position_stack(),
#            vjust=1)+
xlab("") +
ylab("Frequência") +
#ggtitle("Situação de emprego x Expectativa após graduação")+
theme_classic() + theme(legend.position = 'top',
plot.title = element_text(family = "Helvetica",
face = "bold",
size = (20),
hjust = 0.5),
axis.title = element_text(face = "bold",
size = 15),
#axis.text = element_blank(),
#legend.title = element_blank(),
text = element_text(size=15))
table2 <- as.matrix(
prop.table(table(
dados$instrucao,
dados$estado_civil),
mar = 2))
table2 <- as.data.frame(table2)
ggplot(table2,
aes(x=Var2, y=Freq, fill=Var1)) +
geom_bar(stat = 'identity',
col = 1,
lwd = 1)+
#  geom_text(aes(label = freq_r),
#            hjust=0.5,
#            color=1,
#            size=8,
#            position=position_stack(),
#            vjust=1)+
xlab("") +
ylab("Proporção") +
#ggtitle("Situação de emprego x Expectativa após graduação")+
theme_classic() + theme(legend.position = 'top',
plot.title = element_text(family = "Helvetica",
face = "bold",
size = (20),
hjust = 0.5),
axis.title = element_text(face = "bold",
size = 15),
#axis.text = element_blank(),
#legend.title = element_blank(),
text = element_text(size=15))
table2 <- as.matrix(
prop.table(table(
dados$estado_civil,
dados$instrucao),
mar = 2))
table2 <- as.data.frame(table2)
ggplot(table2,
aes(x=Var2, y=Freq, fill=Var1)) +
geom_bar(stat = 'identity',
col = 1,
lwd = 1)+
#  geom_text(aes(label = freq_r),
#            hjust=0.5,
#            color=1,
#            size=8,
#            position=position_stack(),
#            vjust=1)+
xlab("") +
ylab("Proporção") +
#ggtitle("Situação de emprego x Expectativa após graduação")+
theme_classic() + theme(legend.position = 'top',
plot.title = element_text(family = "Helvetica",
face = "bold",
size = (20),
hjust = 0.5),
axis.title = element_text(face = "bold",
size = 15),
#axis.text = element_blank(),
#legend.title = element_blank(),
text = element_text(size=15))
ggplot(data = dados) +
geom_mosaic(aes(x = product(estado_civil, instrucao),
fill=estado_civil)) +
xlab("") +
ylab("") +
#ggtitle("Gráfico de mosaico para\n 2 variáveis categóricas")+
theme_classic() + theme(legend.position = 'top',
plot.title = element_text(family = "Helvetica",
face = "bold",
size = (20),
hjust = 0.5),
axis.title = element_text(face = "bold",
size = 15),
#axis.text = element_blank(),
#legend.title = element_blank(),
text = element_text(size=15))
ggplot(data = dados) +
geom_mosaic(aes(x = product(instrucao, estado_civil),
fill=instrucao)) +
xlab("") +
ylab("") +
#ggtitle("Gráfico de mosaico para\n 2 variáveis categóricas")+
theme_classic() + theme(legend.position = 'top',
plot.title = element_text(family = "Helvetica",
face = "bold",
size = (20),
hjust = 0.5),
axis.title = element_text(face = "bold",
size = 15),
#axis.text = element_blank(),
#legend.title = element_blank(),
text = element_text(size=15))
knitr::all_labels()
?mosaicplot()
#-----------------------------------------------------------------------
library(tidyverse)
dados <- read.csv("milsa.csv")
summary(dados)
names(dados)
tabela <- table(dados$estado_civil,
dados$instrucao)
tabela <- as.data.frame(tabela)
tabela$freq_r <- tabela$Freq/sum(tabela$Freq)
tabela$freq_r <- round(tabela$freq_r, 2)
ggplot(tabela,
aes(x=Var1, y=Freq, fill=Var2)) +
geom_bar(stat = 'identity',
col = 1,
lwd = 1,
position = 'dodge') +
ylim(c(0,
(max(tabela$Freq)+ (max(tabela$Freq)*0.1))))+
geom_text(aes(label = Freq),
#hjust=-0.1,
color=1,
size=8,
position=position_dodge(width=0.9),
vjust=-0.5
)+
xlab("") +
ylab("Frequência") +
#ggtitle("Situação de emprego x Expectativa após graduação")+
theme_classic() + theme(legend.position = 'top',
plot.title = element_text(family = "Helvetica",
face = "bold",
size = (20),
hjust = 0.5),
axis.title = element_text(face = "bold",
size = 15),
#axis.text = element_blank(),
#legend.title = element_blank(),
text = element_text(size=15))
ggplot(tabela,
aes(x=Var2, y=Freq, fill=Var1)) +
geom_bar(stat = 'identity',
col = 1,
lwd = 1,
position = 'dodge') +
ylim(c(0,
(max(tabela$Freq)+ (max(tabela$Freq)*0.1))))+
geom_text(aes(label = Freq),
#hjust=-0.1,
color=1,
size=8,
position=position_dodge(width=0.9),
vjust=-0.5
)+
xlab("") +
ylab("Frequência") +
#ggtitle("Situação de emprego x Expectativa após graduação")+
theme_classic() + theme(legend.position = 'top',
plot.title = element_text(family = "Helvetica",
face = "bold",
size = (20),
hjust = 0.5),
axis.title = element_text(face = "bold",
size = 15),
#axis.text = element_blank(),
#legend.title = element_blank(),
text = element_text(size=15))
ggplot(tabela,
aes(x=Var1, y=Freq, fill=Var2)) +
geom_bar(stat = 'identity',
col = 1,
lwd = 1)+
#  geom_text(aes(label = freq_r),
#            hjust=0.5,
#            color=1,
#            size=8,
#            position=position_stack(),
#            vjust=1)+
xlab("") +
ylab("Frequência") +
#ggtitle("Situação de emprego x Expectativa após graduação")+
theme_classic() + theme(legend.position = 'top',
plot.title = element_text(family = "Helvetica",
face = "bold",
size = (20),
hjust = 0.5),
axis.title = element_text(face = "bold",
size = 15),
#axis.text = element_blank(),
#legend.title = element_blank(),
text = element_text(size=15))
ggplot(tabela,
aes(x=Var2, y=Freq, fill=Var1)) +
geom_bar(stat = 'identity',
col = 1,
lwd = 1)+
#  geom_text(aes(label = freq_r),
#            hjust=0.5,
#            color=1,
#            size=8,
#            position=position_stack(),
#            vjust=1)+
xlab("") +
ylab("Frequência") +
#ggtitle("Situação de emprego x Expectativa após graduação")+
theme_classic() + theme(legend.position = 'top',
plot.title = element_text(family = "Helvetica",
face = "bold",
size = (20),
hjust = 0.5),
axis.title = element_text(face = "bold",
size = 15),
#axis.text = element_blank(),
#legend.title = element_blank(),
text = element_text(size=15))
table2 <- as.matrix(
prop.table(table(
dados$instrucao,
dados$estado_civil),
mar = 2))
table2 <- as.data.frame(table2)
ggplot(table2,
aes(x=Var2, y=Freq, fill=Var1)) +
geom_bar(stat = 'identity',
col = 1,
lwd = 1)+
#  geom_text(aes(label = freq_r),
#            hjust=0.5,
#            color=1,
#            size=8,
#            position=position_stack(),
#            vjust=1)+
xlab("") +
ylab("Proporção") +
#ggtitle("Situação de emprego x Expectativa após graduação")+
theme_classic() + theme(legend.position = 'top',
plot.title = element_text(family = "Helvetica",
face = "bold",
size = (20),
hjust = 0.5),
axis.title = element_text(face = "bold",
size = 15),
#axis.text = element_blank(),
#legend.title = element_blank(),
text = element_text(size=15))
table2 <- as.matrix(
prop.table(table(
dados$estado_civil,
dados$instrucao),
mar = 2))
table2 <- as.data.frame(table2)
ggplot(table2,
aes(x=Var2, y=Freq, fill=Var1)) +
geom_bar(stat = 'identity',
col = 1,
lwd = 1)+
#  geom_text(aes(label = freq_r),
#            hjust=0.5,
#            color=1,
#            size=8,
#            position=position_stack(),
#            vjust=1)+
xlab("") +
ylab("Proporção") +
#ggtitle("Situação de emprego x Expectativa após graduação")+
theme_classic() + theme(legend.position = 'top',
plot.title = element_text(family = "Helvetica",
face = "bold",
size = (20),
hjust = 0.5),
axis.title = element_text(face = "bold",
size = 15),
#axis.text = element_blank(),
#legend.title = element_blank(),
text = element_text(size=15))
ggplot(data = dados) +
geom_mosaic(aes(x = product(estado_civil, instrucao),
fill=estado_civil)) +
xlab("") +
ylab("") +
#ggtitle("Gráfico de mosaico para\n 2 variáveis categóricas")+
theme_classic() + theme(legend.position = 'top',
plot.title = element_text(family = "Helvetica",
face = "bold",
size = (20),
hjust = 0.5),
axis.title = element_text(face = "bold",
size = 15),
#axis.text = element_blank(),
#legend.title = element_blank(),
text = element_text(size=15))
ggplot(data = dados) +
geom_mosaic(aes(x = product(instrucao, estado_civil),
fill=instrucao)) +
xlab("") +
ylab("") +
#ggtitle("Gráfico de mosaico para\n 2 variáveis categóricas")+
theme_classic() + theme(legend.position = 'top',
plot.title = element_text(family = "Helvetica",
face = "bold",
size = (20),
hjust = 0.5),
axis.title = element_text(face = "bold",
size = 15),
#axis.text = element_blank(),
#legend.title = element_blank(),
text = element_text(size=15))
ggplot(data = dados) +
geom_mosaic(aes(x = product(estado_civil, instrucao),
fill=estado_civil)) +
xlab("") +
ylab("") +
#ggtitle("Gráfico de mosaico para\n 2 variáveis categóricas")+
theme_classic() + theme(legend.position = 'top',
plot.title = element_text(family = "Helvetica",
face = "bold",
size = (20),
hjust = 0.5),
axis.title = element_text(face = "bold",
size = 15),
#axis.text = element_blank(),
#legend.title = element_blank(),
text = element_text(size=15))
ggplot(data = dados) +
geom_mosaic(aes(x = product(instrucao, estado_civil),
fill=instrucao)) +
xlab("") +
ylab("") +
#ggtitle("Gráfico de mosaico para\n 2 variáveis categóricas")+
theme_classic() + theme(legend.position = 'top',
plot.title = element_text(family = "Helvetica",
face = "bold",
size = (20),
hjust = 0.5),
axis.title = element_text(face = "bold",
size = 15),
#axis.text = element_blank(),
#legend.title = element_blank(),
text = element_text(size=15))
ggplot(data = dados) +
geom_mosaic(aes(x = product(estado_civil, instrucao),
fill=estado_civil)) +
xlab("") +
ylab("") +
#ggtitle("Gráfico de mosaico para\n 2 variáveis categóricas")+
theme_classic() + theme(legend.position = 'top',
plot.title = element_text(family = "Helvetica",
face = "bold",
size = (20),
hjust = 0.5),
axis.title = element_text(face = "bold",
size = 15),
#axis.text = element_blank(),
#legend.title = element_blank(),
text = element_text(size=15))
